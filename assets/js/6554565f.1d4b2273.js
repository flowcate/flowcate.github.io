"use strict";(self.webpackChunkdeephub_doc=self.webpackChunkdeephub_doc||[]).push([[1536],{37623:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>p,frontMatter:()=>a,metadata:()=>l,toc:()=>d});var t=o(85893),i=o(11151),r=o(70387);o(54948),o(74866),o(85162);const a={sidebar_label:"Running the DeepHub\xae Locally",title:"Running the DeepHub\xae Locally",sidebar_position:2},s=void 0,l={id:"testing-deephub/running_dh_locally",title:"Running the DeepHub\xae Locally",description:"Getting Started",source:"@site/versioned_docs/version-DeepHub 2022 R2 - 2.2.3/testing-deephub/running_dh_locally.mdx",sourceDirName:"testing-deephub",slug:"/testing-deephub/running_dh_locally",permalink:"/docs/DeepHub 2022 R2 - 2.2.3/testing-deephub/running_dh_locally",draft:!1,unlisted:!1,tags:[],version:"DeepHub 2022 R2 - 2.2.3",sidebarPosition:2,frontMatter:{sidebar_label:"Running the DeepHub\xae Locally",title:"Running the DeepHub\xae Locally",sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Trial Instances in the Cloud",permalink:"/docs/DeepHub 2022 R2 - 2.2.3/testing-deephub/demo_access"},next:{title:"Changelog",permalink:"/docs/DeepHub 2022 R2 - 2.2.3/release-note"}},c={},d=[{value:"Getting Started",id:"getting-started",level:2},{value:"System Prerequisites",id:"system-prerequisites",level:2},{value:"Docker",id:"docker",level:3},{value:"Windows PowerShell or Command Prompt",id:"windows-powershell-or-command-prompt",level:3},{value:"Terminal for Linux &amp; macOS",id:"terminal-for-linux--macos",level:3},{value:"Docker and Docker Compose",id:"docker-and-docker-compose",level:2},{value:"Using Docker or Docker Compose",id:"using-docker-or-docker-compose",level:3},{value:"Getting the Latest Docker Compose File",id:"getting-the-latest-docker-compose-file",level:3},{value:"Explanation of the Docker Compose File",id:"explanation-of-the-docker-compose-file",level:3},{value:"Start a DeepHub\xae",id:"start-a-deephub",level:3},{value:"Stop a running DeepHub\xae",id:"stop-a-running-deephub",level:3},{value:"Install Specific Version",id:"install-specific-version",level:2},{value:"Pulling Specific Containers",id:"pulling-specific-containers",level:3},{value:"DeepHub\xae UI Configuration",id:"deephub-ui-configuration",level:2},{value:"Adding a Floorplan Image to the Map",id:"adding-a-floorplan-image-to-the-map",level:3},{value:"Displaying a Floorplan Image by Itself",id:"displaying-a-floorplan-image-by-itself",level:4},{value:"Displaying a Floorplan Image over a Basemap",id:"displaying-a-floorplan-image-over-a-basemap",level:4},{value:"Multi-Level Floorplans",id:"multi-level-floorplans",level:4}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(r.Z,{children:[(0,t.jsx)(n.h2,{id:"getting-started",children:"Getting Started"}),(0,t.jsx)(n.p,{children:"This tutorial is designed for partners and customers as a step-by-step guide when working with the DeepHub\xae.\nIt includes the following sections:"}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"System Prerequisites for the DeepHub\xae"})," - This section provides information on prerequisites of the system in terms of the software tools and technical knowledge needed for the DeepHub\xae installation."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Install the DeepHub\xae"})," - This section provides step-by-step instructions on how to install the DeepHub\xae."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"User Instructions for the DeepHub\xae"})," - This section provides essential information on how to operate the DeepHub\xae from the end user perspective."]}),"\n"]})]}),"\n",(0,t.jsxs)(r.Z,{children:[(0,t.jsx)(n.h2,{id:"system-prerequisites",children:"System Prerequisites"}),(0,t.jsx)(n.h3,{id:"docker",children:"Docker"}),(0,t.jsx)(n.p,{children:"Docker is an open-source project for automating the deployment of applications as portable, self-sufficient containers that can run on the cloud or on-premises.\nDocker image containers can run natively on Linux and Windows. Developers can use development environments on Windows, Linux, or macOS. On the development computer, the developer may run a Docker host where Docker images are deployed."}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Image: A Docker image is a file, comprised of multiple layers, that is used to execute code in a Docker container. It is a package that contains all necessary files for a containerized application to run. When the Docker user runs an image, it can become one or multiple instances of the container."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Container: An instance of a Docker image. A container represents the execution of a single application, process, or service. It consists of the contents of a Docker image, an execution environment, and a standard set of instructions."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Docker Compose: A tool for defining and running multi-container Docker applications."}),"\n"]}),"\n"]}),(0,t.jsxs)(n.p,{children:["Based on your operating system, you can download and install Docker Desktop here: ",(0,t.jsx)(n.a,{href:"https://docs.docker.com/desktop/",children:"Docker Desktop"}),".\nWhile installing Docker on your machine, ensure you allow the installation to bypass any firewall settings (if prompted). Once the installation process is complete, your machine will restart."]}),(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsx)(n.p,{children:"When Docker Desktop is installed on Windows, the entire package is installed (including Docker Compose). With Ubuntu, the user needs to install Docker and the Docker Compose separately."})}),(0,t.jsx)(n.h3,{id:"windows-powershell-or-command-prompt",children:"Windows PowerShell or Command Prompt"}),(0,t.jsxs)(n.p,{children:["A shell is a user interface that gives you access to various services of an operating system.\nA shell can be command-line based, or it can include a graphical user interface (GUI).\nWindows PowerShell is a shell developed by Microsoft for task automation and configuration management.\nIt is cross-platform and consists of a command-line shell and scripting language.\nPowerShell capabilities allow users to simplify and automate repetitive tasks by creating scripts and combining multiple commands.\nThe Windows operating system comes with Windows PowerShell pre-installed. However, Windows PowerShell can be installed for other operating systems here: ",(0,t.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/powershell/scripting/install/installing-powershell-core-on-windows?view=powershell-7",children:"Windows PowerShell"}),".\nAside from Windows PowerShell, the classic Windows Command Prompt is also pre-installed and can be used for tasks at hand."]}),(0,t.jsx)(n.h3,{id:"terminal-for-linux--macos",children:"Terminal for Linux & macOS"}),(0,t.jsxs)(n.p,{children:["A terminal is a program that allows the use of the command-line in a graphical environment.\nIn a Linux system, the shell is a command-line interface that interprets a user\u2019s commands and script files, and notifies the server\u2019s operating system what to do with them.\nTerminal is pre-installed on Linux and macOS. For more information, please read ",(0,t.jsx)(n.a,{href:"https://ubuntu.com/tutorials/command-line-for-beginners#1-overview",children:"Ubuntu Tutorials"}),"."]})]}),"\n",(0,t.jsxs)(r.Z,{children:[(0,t.jsx)(n.h2,{id:"docker-and-docker-compose",children:"Docker and Docker Compose"}),(0,t.jsxs)(n.p,{children:["Using Docker or Docker Compose on Windows and Linux is done via a command line shell and is almost identical on both platforms. You can use PowerShell or Command Prompt on Windows and a shell like bash or zsh on Linux.\nRefer to ",(0,t.jsx)(n.a,{href:"#system-prerequisites",children:"DeepHub System Prerequisites"})," for details."]}),(0,t.jsx)(n.h3,{id:"using-docker-or-docker-compose",children:"Using Docker or Docker Compose"}),(0,t.jsx)(n.p,{children:'We recommend using Docker Compose because this way you will get a completely configured "system" consisting of the DeepHub\xae, the DeepHub\xae UI and a containerized web server, acting as a reverse proxy, to simplify\nthe overall usage and interaction of these components.'}),(0,t.jsx)(n.p,{children:"We provide a Docker Compose file that configures the necessary orchestration between these three containers. Refer to the next section in this documentation concerning more details on this."}),(0,t.jsx)(n.p,{children:"Nevertheless, you are able to pull just the Docker container that you need instead of all three."}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker pull flowcate/deephub:<tag of release you want to pull>\n"})}),(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:["The DeepHub\xae itself, as well as the corresponding DeepHub\xae UI, are available at Docker Hub: ",(0,t.jsx)(n.a,{href:"https://hub.docker.com/u/flowcate",children:"Flowcate@docker"}),"."]})}),(0,t.jsx)(n.h3,{id:"getting-the-latest-docker-compose-file",children:"Getting the Latest Docker Compose File"}),(0,t.jsxs)(n.p,{children:["We provide a docker-compose.yml file and additional configuration files for orchestration of the DeepHub\xae itself, as well as the corresponding DeepHub\xae UI, in our Github repository: ",(0,t.jsx)(n.a,{href:"https://github.com/flowcate/deephub-basic-setup",children:"deephub-basic-setup by Flowcate@github"}),"."]}),(0,t.jsx)(n.p,{children:"We recommend creating a dedicated local directory on your filesystem where you store the docker-compose.yml and the aforementioned configuration files which is what happens if you use git clone to pull the complete repository."}),(0,t.jsx)(n.p,{children:"The DeepHub\xae needs to create some additional files during operations and writes them to directories mounted from your host filesystem. This is done relative to the location of the docker-compose.yml file and will therefore happen within some of the directories that are part of the deephub-basic-setup repository."}),(0,t.jsx)(n.h3,{id:"explanation-of-the-docker-compose-file",children:"Explanation of the Docker Compose File"}),(0,t.jsx)(n.p,{children:'Our Docker Compose file consists of four "services":'}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:'"deephub"'}),"\n",(0,t.jsx)(n.li,{children:'"deephub-admin-ui"'}),"\n",(0,t.jsx)(n.li,{children:'"deephub-apache"'}),"\n"]}),(0,t.jsx)(n.p,{children:"Each corresponds to one Docker container (indicated by the name).\nWithin each service section, Docker specific details can be configured as well as environment variables for the processes running within a container. Let's pick an example section:"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"deephub:\n  image: flowcate/deephub:latest\n  container_name: 8081-deephub\n  restart: unless-stopped\n  read_only: true\n  logging:\n    driver: 'json-file'\n    options:\n      max-file: '2'\n      max-size: '10m'\n  environment:\n    - DEEPHUB_PORT=7081\n    - DEEPHUB_CORS=true\n    - DEEPHUB_LICENSE_KEY=50f7eb6d-4b4c-4a7b-8d60-0c439328214c\n    - SQLITE_TMPDIR=/data\n  ports:\n    - '7081'\n  volumes:\n    - './hub-data/:/data'\n  networks:\n    - deephub-net\n"})}),(0,t.jsx)(n.p,{children:'First of all, there is the service name. In this case, it is "deephub". Next are Docker specific parameters, such as the image name and tag, the name of the container that is built from it, the restart policy, and whether the container should run in read-only mode. If the latter is set to "true", no process running within the container is allowed to write to the Docker container\'s own filesystem. Next there are Docker parameters for logging.'}),(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.strong,{children:"environment"})," key begins the section containing the environment variables that are made available within the Docker container. You'll notice DeepHub-specific ones, of course, such as the port on which the DeepHub should listen. ",(0,t.jsx)(n.strong,{children:"All DeepHub-specific environment variables start with DEEPHUB, an underscore, and the capital spelling of the parameter"}),' as specified in the "Server Configuration" section further down this documentation.\nNote the ',(0,t.jsx)(n.strong,{children:"SQLITE_TMPDIR"})," variable: it is necessary to specify a path to which the SQlite DB can write temporary information. The path has to be a known path from the point of view of the container and has to be writable."]}),(0,t.jsxs)(n.p,{children:["Note concerning the port number specified: this is the port number within the docker container. It is not necessarily identical to the port on which the process is reachable from outside of the container though. It is the following section called ",(0,t.jsx)(n.strong,{children:"ports"}),' that make this port available from the outside. In this case, it is the same port as the DeepHub process uses within the container. Instead of that simple entry, a "port mapping" could have been specified. The latter is nothing more than specifying the outside port number and the corresponding inside port number to which it should be mapped. For more details please refer to the Docker and Docker Compose documentation.']}),(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.strong,{children:"volumes"}),' section is important to mention because it presents the mapping/mounting of external directories to container internal ones. In the example above, the external/host directory called "hub-data", relative to the location of the docker-compose.yml, is mapped to the absolute path /data within the container. ',(0,t.jsx)(n.strong,{children:"The read-only container can write to this external directory in case the user and group permissions on the host filesystem are set appropriately."})]}),(0,t.jsx)(n.h3,{id:"start-a-deephub",children:"Start a DeepHub\xae"}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Open a shell (PowerShell or Command Prompt on Windows, a terminal on Linux or macOS)"}),"\n",(0,t.jsxs)(n.li,{children:["Change to the directory where your docker-compose.yml file resides. ",(0,t.jsx)(n.strong,{children:"Docker Compose won't work if invoked outside this directory."})]}),"\n",(0,t.jsx)(n.li,{children:"Invoke Docker Compose. It will take a few minutes to download the Docker images and set up the DeepHub\xae."}),"\n"]}),(0,t.jsx)(n.p,{children:"Example:"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cd <directory where the docker-compose.yml is>\ndocker compose up -d\n"})}),(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsx)(n.p,{children:"On Linux, it may be necessary to call docker compose as superuser via the sudo command."})}),(0,t.jsxs)(n.p,{children:["Now you have your own running DeepHub\xae instance that can be accessed with any modern web browser at the address: ",(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"http://localhost:8081",children:"http://localhost:8081"})})]}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"The DeepHub UI",src:o(3327).Z+"",width:"3047",height:"1568"})}),(0,t.jsx)(n.p,{children:"To complement the DeepHub UI shown above, you may also make API calls to the DeepHub REST API while running the DeepHub locally. This can be done with a tool such as Postman or cURL."}),(0,t.jsx)(n.p,{children:"The containerized web server included in the Docker Compose bundle acts as a reverse proxy - forwarding requests to either the DeepHub UI or DeepHub containers."}),(0,t.jsxs)(n.p,{children:["To interact with the REST API, you will need to use the following baseURL: ",(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"http://localhost:8081/deephub/v1",children:"http://localhost:8081/deephub/v1"})})]}),(0,t.jsx)(n.p,{children:"For example, retrieve an array of all zones:"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl http://localhost:8081/deephub/v1/zones/summary | json_pp\n"})}),(0,t.jsx)(n.h3,{id:"stop-a-running-deephub",children:"Stop a running DeepHub\xae"}),(0,t.jsx)(n.p,{children:"Please make sure you are in the same directory where you invoked docker compose."}),(0,t.jsx)(n.p,{children:"To stop a running DeepHub\xae, execute 'docker compose down'. This ensures the running DeepHub\xae is stopped and allows the user to modify the configuration data."}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:"title='Example'",children:"cd <directory where the docker-compose.yml is>\ndocker compose down\n"})}),(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsx)(n.p,{children:"On Linux, it may be necessary to call docker compose as superuser via the sudo command."})})]}),"\n",(0,t.jsxs)(r.Z,{children:[(0,t.jsx)(n.h2,{id:"install-specific-version",children:"Install Specific Version"}),(0,t.jsx)(n.p,{children:"It is possible to switch to a specific version of the DeepHub\xae instead of the latest one, if required."}),(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["Before installing a specific version of the DeepHub\xae, it is mandatory to stop a running DeepHub as ",(0,t.jsx)(n.a,{href:"#stop-a-running-deephub",children:"described above"}),"."]})}),(0,t.jsx)(n.h3,{id:"pulling-specific-containers",children:"Pulling Specific Containers"}),(0,t.jsx)(n.p,{children:'Open the \u201cdocker-compose.yml\u201d file. Edit the version of the DeepHub\xae from \u201clatest\u201d to the desired version. For example, it can be modified from "latest" to \u201c2.0.0\u201d.\nSimilarly, the version of DeepHub\xae UI can be adapted accordingly.'}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"docker-compose.yml file",src:o(61438).Z+"",width:"1762",height:"1175"})}),(0,t.jsx)("br",{}),(0,t.jsx)(n.p,{children:"Now, the specified version is pulled when executing the following command:"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker compose pull\n"})}),(0,t.jsxs)(n.p,{children:["To start the pulled version, use the typical command described above in ",(0,t.jsx)(n.a,{href:"#start-a-deephub",children:"Start a DeepHub\xae"}),"."]})]}),"\n",(0,t.jsxs)(r.Z,{children:[(0,t.jsx)(n.h2,{id:"deephub-ui-configuration",children:"DeepHub\xae UI Configuration"}),(0,t.jsx)(n.h3,{id:"adding-a-floorplan-image-to-the-map",children:"Adding a Floorplan Image to the Map"}),(0,t.jsx)(n.p,{children:"The DeepHub UI can be configured so that a floorplan image of a building or a site can be displayed. You may choose to display the image by itself, or overlayed on top of the basemap of the mapping service provider (ex. MapTiler)."}),(0,t.jsx)(n.p,{children:"To begin, you will need to determine the latitude and longitude of your floorplan images' corners."}),(0,t.jsx)(n.p,{children:"Once this is done, navigate to the '/hub-web/nginx/webapp' directory of your DeepHub bundle on your local filesystem. Create a new directory (ex. named 'floorplan-image') and add your floorplan image to this directory."}),(0,t.jsxs)(n.p,{children:["Next, download the Open Sans Semibold font by cloning ",(0,t.jsx)(n.a,{href:"https://github.com/openmaptiles/fonts",children:"this repository"})," to your local filesystem. Follow the steps in the README.md to install the required packages and generate the fonts. The fonts will be in the '_output' directory."]}),(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsx)(n.p,{children:"Your machine will need Node.js installed to generate the fonts."})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"user@fc:~/projects/fonts/_output$ ls\n'Metropolis Black'               'Metropolis Light'             'Metropolis Thin'         'Open Sans Extra Bold Italic'  'PT Sans Bold Italic'       'Roboto Black Italic'            'Roboto Condensed Regular'  'Roboto Thin Italic'\n'Metropolis Black Italic'        'Metropolis Light Italic'      'Metropolis Thin Italic'  'Open Sans Italic'             'PT Sans Caption Regular'   'Roboto Bold'                    'Roboto Italic'\n'Metropolis Bold'                'Metropolis Medium'            'Noto Sans Bold'          'Open Sans Light'              'PT Sans Caption Web Bold'  'Roboto Bold Italic'             'Roboto Light'\n'Metropolis Bold Italic'         'Metropolis Medium Italic'     'Noto Sans Italic'        'Open Sans Light Italic'       'PT Sans Italic'            'Roboto Condensed Bold'          'Roboto Light Italic'\n'Metropolis Extra Bold'          'Metropolis Regular'           'Noto Sans Regular'       'Open Sans Regular'            'PT Sans Narrow Bold'       'Roboto Condensed Bold Italic'   'Roboto Medium'\n'Metropolis Extra Bold Italic'   'Metropolis Regular Italic'    'Open Sans Bold'          'Open Sans Semibold'           'PT Sans Narrow Regular'    'Roboto Condensed Italic'        'Roboto Medium Italic'\n'Metropolis Extra Light'         'Metropolis Semi Bold'         'Open Sans Bold Italic'   'Open Sans Semibold Italic'    'PT Sans Regular'           'Roboto Condensed Light'         'Roboto Regular'\n'Metropolis Extra Light Italic'  'Metropolis Semi Bold Italic'  'Open Sans Extra Bold'    'PT Sans Bold'                 'Roboto Black'              'Roboto Condensed Light Italic'  'Roboto Thin'\n"})}),(0,t.jsx)(n.p,{children:"Within your newly-created 'floorplan-image' directory, create a new directory named 'fonts'. Copy the 'Open Sans Semibold' font from the repository you just cloned to this new 'fonts' directory."}),(0,t.jsx)(n.h4,{id:"displaying-a-floorplan-image-by-itself",children:"Displaying a Floorplan Image by Itself"}),(0,t.jsx)(n.p,{children:"Create a JSON file in your 'floorplan-image' directory that defines your map style. To display the floorplan image without the surrounding basemap, your file must be structured like the following:"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "version": 8,\n  "id": "floorplan-style",\n  "name": "Floorplan Style",\n  "attribution": "Floorplan map",\n  "glyphs": "floorplan-image/fonts/{fontstack}/{range}.pbf",\n  "sources": {\n    "image": {\n      "type": "image",\n      "url": "floorplan-image/<YOUR FLOORPLAN IMAGE FILE>",\n      "coordinates": [\n        [-115.16786551712569, 36.11988219161837],\n        [-115.1654992, 36.119895],\n        [-115.1649202, 36.118001],\n        [-115.1684502, 36.118023]\n      ]\n    }\n  },\n  "layers": [\n    {\n      "id": "background",\n      "type": "background",\n      "paint": {\n        "background-color": "rgba(0,0,0,0)"\n      }\n    },\n    {\n      "id": "image-layer",\n      "type": "raster",\n      "source": "image",\n      "paint": {\n        "raster-fade-duration": 0\n      }\n    }\n  ]\n}\n'})}),(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsx)(n.p,{children:"You will need to change the coordinates in your JSON file to match the coordinates of your floorplan images' corners. The first coordinate corresponds to the top left corner of the image, the 2nd coordinate corresponds to the top right corner of the image, etc."})}),(0,t.jsx)(n.p,{children:"Finally, the 'deephub-ui' service within the docker-compose.yml file of your DeepHub instance needs to be modified:"}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Set DOCKER_MAP_DEFAULT_STYLE=floorplan-image/YOUR MAP STYLE JSON FILE"}),"\n",(0,t.jsx)(n.li,{children:'Ensure that the "./hub-web/nginx/webapp/" volume on your local filesystem is mounted to "/webapp" of the Docker container'}),"\n"]}),(0,t.jsx)(n.p,{children:"Start your DeepHub instance by invoking Docker Compose. When you open the DeepHub UI in your browser, you will need to modify the URL by including one pair of latitude and longitude coordinates. For example, to navigate to the location of the floorplan image in the example above, the following URL would be used:"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"http://localhost:8081/deephub-ui/map/system/live/(show//left:list)?lng=-115.16786551712569&lat=36.11988219161837&zoom=17\n"})}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Floorplan image in UI",src:o(38781).Z+"",width:"3837",height:"2005"})}),(0,t.jsx)(n.h4,{id:"displaying-a-floorplan-image-over-a-basemap",children:"Displaying a Floorplan Image over a Basemap"}),(0,t.jsx)(n.p,{children:"To display your floorplan image on top of a basemap from a mapping service provider, you will need to modify your JSON file above, or create a new one."}),(0,t.jsxs)(n.p,{children:["Combine the properties associated with your floorplan image with the map style JSON of the mapping service provider. By default, MapTiler is used as the mapping service provider with this map style: ",(0,t.jsx)(n.a,{href:"https://api.maptiler.com/maps/bright/style.json",children:"https://api.maptiler.com/maps/bright/style.json"}),"."]}),(0,t.jsx)(n.p,{children:"In addition, you will need to ensure that the docker-compose.yml file of your DeepHub instance has the correct value for DOCKER_MAP_DEFAULT_STYLE. This environment variable should point to the location of the updated map style JSON file on your local filesystem. For example:"}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"DOCKER_MAP_DEFAULT_STYLE=floorplan-image/YOUR UPDATED MAP STYLE JSON FILE"}),"\n"]}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Floorplan image in UI over basemap",src:o(89712).Z+"",width:"3832",height:"2005"})}),(0,t.jsx)(n.h4,{id:"multi-level-floorplans",children:"Multi-Level Floorplans"}),(0,t.jsx)(n.p,{children:"If the building or site has multiple floors, you will need to include a floorplan image for each individual floor."}),(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsx)(n.p,{children:"Your DeepHub instance will need to have zones, fences, trackables, or location providers on each floor that needs to display a floorplan image."})}),(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"#adding-a-floorplan-image-to-the-map",children:"As described above"}),", you will first need to determine the latitude and longitude of the corners of each floorplan image and ensure each floorplan image is included in the 'floorplan-image' directory."]}),(0,t.jsx)(n.p,{children:'Modify your map style JSON by including "minlevel" and "maxlevel" as properties. By default, the map starts at floor 0.'}),(0,t.jsx)(n.p,{children:"For example, to display a two-floor building without the surrounding basemap, your map style JSON would be structured in the following way:"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "version": 8,\n  "id": "floorplan-style",\n  "name": "Floorplan Style",\n  "attribution": "Floorplan map",\n  "glyphs": "floorplan-image/fonts/{fontstack}/{range}.pbf",\n  "sources": {\n    "floor0": {\n      "type": "image",\n      "url": "floorplan-image/<YOUR FLOORPLAN IMAGE FILE FOR FLOOR 0>",\n      "coordinates": [\n        [-115.16786551712569, 36.11988219161837],\n        [-115.1654992, 36.119895],\n        [-115.1649202, 36.118001],\n        [-115.1684502, 36.118023]\n      ]\n    },\n    "floor1": {\n      "type": "image",\n      "url": "floorplan-image/<YOUR FLOORPLAN IMAGE FILE FOR FLOOR 1>",\n      "coordinates": [\n        [-115.16786551712569, 36.11988219161837],\n        [-115.1654992, 36.119895],\n        [-115.1649202, 36.118001],\n        [-115.1684502, 36.118023]\n      ]\n    }\n  },\n  "layers": [\n    {\n      "id": "background",\n      "type": "background",\n      "paint": {\n        "background-color": "rgba(0,0,0,0)"\n      }\n    },\n    {\n      "id": "floor0-layer",\n      "type": "raster",\n      "source": "floor0",\n      "paint": {\n        "raster-fade-duration": 0\n      },\n      "minlevel": 0,\n      "maxlevel": 1\n    },\n    {\n      "id": "floor1-layer",\n      "type": "raster",\n      "source": "floor1",\n      "paint": {\n        "raster-fade-duration": 0\n      },\n      "minlevel": 1,\n      "maxlevel": 2\n    }\n  ]\n}\n'})}),(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsx)(n.p,{children:'The value of the "minlevel" property corresponds with the floor upon which the floorplan image is displayed in the DeepHub UI. The value of the "maxlevel" property is always the subsequent floor.'})})]})]})}function p(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},85162:(e,n,o)=>{o.d(n,{Z:()=>a});o(67294);var t=o(90512);const i={tabItem:"tabItem_Ymn6"};var r=o(85893);function a(e){let{children:n,hidden:o,className:a}=e;return(0,r.jsx)("div",{role:"tabpanel",className:(0,t.Z)(i.tabItem,a),hidden:o,children:n})}},74866:(e,n,o)=>{o.d(n,{Z:()=>j});var t=o(67294),i=o(90512),r=o(12466),a=o(16550),s=o(20469),l=o(91980),c=o(67392),d=o(50012);function h(e){return t.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,t.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:n,children:o}=e;return(0,t.useMemo)((()=>{const e=n??function(e){return h(e).map((e=>{let{props:{value:n,label:o,attributes:t,default:i}}=e;return{value:n,label:o,attributes:t,default:i}}))}(o);return function(e){const n=(0,c.l)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,o])}function u(e){let{value:n,tabValues:o}=e;return o.some((e=>e.value===n))}function m(e){let{queryString:n=!1,groupId:o}=e;const i=(0,a.k6)(),r=function(e){let{queryString:n=!1,groupId:o}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!o)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return o??null}({queryString:n,groupId:o});return[(0,l._X)(r),(0,t.useCallback)((e=>{if(!r)return;const n=new URLSearchParams(i.location.search);n.set(r,e),i.replace({...i.location,search:n.toString()})}),[r,i])]}function f(e){const{defaultValue:n,queryString:o=!1,groupId:i}=e,r=p(e),[a,l]=(0,t.useState)((()=>function(e){let{defaultValue:n,tabValues:o}=e;if(0===o.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!u({value:n,tabValues:o}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${o.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const t=o.find((e=>e.default))??o[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:r}))),[c,h]=m({queryString:o,groupId:i}),[f,g]=function(e){let{groupId:n}=e;const o=function(e){return e?`docusaurus.tab.${e}`:null}(n),[i,r]=(0,d.Nk)(o);return[i,(0,t.useCallback)((e=>{o&&r.set(e)}),[o,r])]}({groupId:i}),b=(()=>{const e=c??f;return u({value:e,tabValues:r})?e:null})();(0,s.Z)((()=>{b&&l(b)}),[b]);return{selectedValue:a,selectValue:(0,t.useCallback)((e=>{if(!u({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);l(e),h(e),g(e)}),[h,g,r]),tabValues:r}}var g=o(72389);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var y=o(85893);function x(e){let{className:n,block:o,selectedValue:t,selectValue:a,tabValues:s}=e;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,r.o5)(),d=e=>{const n=e.currentTarget,o=l.indexOf(n),i=s[o].value;i!==t&&(c(n),a(i))},h=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const o=l.indexOf(e.currentTarget)+1;n=l[o]??l[0];break}case"ArrowLeft":{const o=l.indexOf(e.currentTarget)-1;n=l[o]??l[l.length-1];break}}n?.focus()};return(0,y.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":o},n),children:s.map((e=>{let{value:n,label:o,attributes:r}=e;return(0,y.jsx)("li",{role:"tab",tabIndex:t===n?0:-1,"aria-selected":t===n,ref:e=>l.push(e),onKeyDown:h,onClick:d,...r,className:(0,i.Z)("tabs__item",b.tabItem,r?.className,{"tabs__item--active":t===n}),children:o??n},n)}))})}function v(e){let{lazy:n,children:o,selectedValue:i}=e;const r=(Array.isArray(o)?o:[o]).filter(Boolean);if(n){const e=r.find((e=>e.props.value===i));return e?(0,t.cloneElement)(e,{className:"margin-top--md"}):null}return(0,y.jsx)("div",{className:"margin-top--md",children:r.map(((e,n)=>(0,t.cloneElement)(e,{key:n,hidden:e.props.value!==i})))})}function w(e){const n=f(e);return(0,y.jsxs)("div",{className:(0,i.Z)("tabs-container",b.tabList),children:[(0,y.jsx)(x,{...e,...n}),(0,y.jsx)(v,{...e,...n})]})}function j(e){const n=(0,g.Z)();return(0,y.jsx)(w,{...e,children:h(e.children)},String(n))}},54948:(e,n,o)=>{o.d(n,{Z:()=>i});o(67294);var t=o(85893);function i(e){let{children:n}=e;return(0,t.jsx)("div",{className:"mb-3 rounded border border-card shadow-md",children:(0,t.jsx)("div",{className:"card-body p-4",children:n})})}},70387:(e,n,o)=>{o.d(n,{Z:()=>i});o(67294);var t=o(85893);function i(e){let{children:n}=e;return(0,t.jsx)("section",{className:"section markdown",children:n})}},3327:(e,n,o)=>{o.d(n,{Z:()=>t});const t=o.p+"assets/images/deephub-ui-03f4447adc906003404b1e821c9415b0.jpg"},61438:(e,n,o)=>{o.d(n,{Z:()=>t});const t=o.p+"assets/images/docker_yml_edit-a6520f3ab58f8bbfa9831142a322f8a9.png"},38781:(e,n,o)=>{o.d(n,{Z:()=>t});const t=o.p+"assets/images/floorplan_alone-5d9b89bf7ace2f6348eaf070ad5d2a5b.png"},89712:(e,n,o)=>{o.d(n,{Z:()=>t});const t=o.p+"assets/images/floorplan_basemap-bb809b2cf393b5414c8c36d584cb5e9e.png"},11151:(e,n,o)=>{o.d(n,{Z:()=>s,a:()=>a});var t=o(67294);const i={},r=t.createContext(i);function a(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);
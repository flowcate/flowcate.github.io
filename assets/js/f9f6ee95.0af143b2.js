"use strict";(self.webpackChunkdeephub_doc=self.webpackChunkdeephub_doc||[]).push([[4642],{3905:(e,t,o)=>{o.d(t,{Zo:()=>c,kt:()=>h});var n=o(67294);function a(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function i(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function r(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?i(Object(o),!0).forEach((function(t){a(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):i(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function l(e,t){if(null==e)return{};var o,n,a=function(e,t){if(null==e)return{};var o,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)o=i[n],t.indexOf(o)>=0||(a[o]=e[o]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)o=i[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}var s=n.createContext({}),p=function(e){var t=n.useContext(s),o=t;return e&&(o="function"==typeof e?e(t):r(r({},t),e)),o},c=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var o=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=p(o),m=a,h=d["".concat(s,".").concat(m)]||d[m]||u[m]||i;return o?n.createElement(h,r(r({ref:t},c),{},{components:o})):n.createElement(h,r({ref:t},c))}));function h(e,t){var o=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=o.length,r=new Array(i);r[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[d]="string"==typeof e?e:a,r[1]=l;for(var p=2;p<i;p++)r[p]=o[p];return n.createElement.apply(null,r)}return n.createElement.apply(null,o)}m.displayName="MDXCreateElement"},70387:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(67294);function a(e){let{children:t}=e;return n.createElement("section",{className:"section markdown"},t)}},89685:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>p,contentTitle:()=>l,default:()=>m,frontMatter:()=>r,metadata:()=>s,toc:()=>c});var n=o(87462),a=(o(67294),o(3905)),i=o(70387);const r={sidebar_label:"Running the DeepHub\xae Locally",title:"Running the DeepHub\xae Locally",sidebar_position:2},l=void 0,s={unversionedId:"testing-deephub/running_dh_locally",id:"testing-deephub/running_dh_locally",title:"Running the DeepHub\xae Locally",description:"Getting Started",source:"@site/docs/testing-deephub/running_dh_locally.mdx",sourceDirName:"testing-deephub",slug:"/testing-deephub/running_dh_locally",permalink:"/docs/testing-deephub/running_dh_locally",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_label:"Running the DeepHub\xae Locally",title:"Running the DeepHub\xae Locally",sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Trial Instances in the Cloud",permalink:"/docs/testing-deephub/demo_access"},next:{title:"Changelog",permalink:"/docs/release-note"}},p={},c=[{value:"Getting Started",id:"getting-started",level:2},{value:"System Prerequisites",id:"system-prerequisites",level:2},{value:"Docker",id:"docker",level:3},{value:"Windows PowerShell or Command Prompt",id:"windows-powershell-or-command-prompt",level:3},{value:"Terminal for Linux &amp; macOS",id:"terminal-for-linux--macos",level:3},{value:"Docker and Docker Compose",id:"docker-and-docker-compose",level:2},{value:"Using Docker or Docker Compose",id:"using-docker-or-docker-compose",level:3},{value:"Getting the Latest Docker Compose File",id:"getting-the-latest-docker-compose-file",level:3},{value:"Explanation of the Docker Compose File",id:"explanation-of-the-docker-compose-file",level:3},{value:"Start a DeepHub\xae",id:"start-a-deephub",level:3},{value:"Stop a running DeepHub\xae",id:"stop-a-running-deephub",level:3},{value:"Install Specific Version",id:"install-specific-version",level:2},{value:"Pulling Specific Containers",id:"pulling-specific-containers",level:3},{value:"DeepHub\xae UI Configuration",id:"deephub-ui-configuration",level:2},{value:"Adding a Floorplan Image to the Map",id:"adding-a-floorplan-image-to-the-map",level:3},{value:"Displaying a Floorplan Image by Itself",id:"displaying-a-floorplan-image-by-itself",level:3},{value:"Displaying a Floorplan Image over a Basemap",id:"displaying-a-floorplan-image-over-a-basemap",level:3},{value:"Multi-Level Floorplans",id:"multi-level-floorplans",level:3}],d={toc:c},u="wrapper";function m(e){let{components:t,...r}=e;return(0,a.kt)(u,(0,n.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)(i.Z,{mdxType:"Section"},(0,a.kt)("h2",{id:"getting-started"},"Getting Started"),(0,a.kt)("p",null,"This tutorial is designed for partners and customers as a step-by-step guide when working with the DeepHub\xae.\nIt includes the following sections:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"System Prerequisites for the DeepHub\xae")," - This section provides information on prerequisites of the system in terms of the software tools and technical knowledge needed for the DeepHub\xae installation."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Install the DeepHub\xae")," - This section provides step-by-step instructions on how to install the DeepHub\xae."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"User Instructions for the DeepHub\xae")," - This section provides essential information on how to operate the DeepHub\xae from the end user perspective."))),(0,a.kt)(i.Z,{mdxType:"Section"},(0,a.kt)("h2",{id:"system-prerequisites"},"System Prerequisites"),(0,a.kt)("h3",{id:"docker"},"Docker"),(0,a.kt)("p",null,"Docker is an open-source project for automating the deployment of applications as portable, self-sufficient containers that can run on the cloud or on-premises.\nDocker image containers can run natively on Linux and Windows. Developers can use development environments on Windows, Linux, or macOS. On the development computer, the developer may run a Docker host where Docker images are deployed."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Image: A Docker image is a file, comprised of multiple layers, that is used to execute code in a Docker container. It is a package that contains all necessary files for a containerized application to run. When the Docker user runs an image, it can become one or multiple instances of the container.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Container: An instance of a Docker image. A container represents the execution of a single application, process, or service. It consists of the contents of a Docker image, an execution environment, and a standard set of instructions.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Docker Compose: A tool for defining and running multi-container Docker applications."))),(0,a.kt)("p",null,"Based on your operating system, you can download and install Docker Desktop here: ",(0,a.kt)("a",{parentName:"p",href:"https://docs.docker.com/desktop/"},"Docker Desktop"),".\nWhile installing Docker on your machine, ensure you allow the installation to bypass any firewall settings (if prompted). Once the installation process is complete, your machine will restart."),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"When Docker Desktop is installed on Windows, the entire package is installed (including Docker Compose). With Ubuntu, the user needs to install Docker and Docker Compose separately.")),(0,a.kt)("h3",{id:"windows-powershell-or-command-prompt"},"Windows PowerShell or Command Prompt"),(0,a.kt)("p",null,"A shell is a user interface that gives you access to various services of an operating system.\nA shell can be command-line based, or it can include a graphical user interface (GUI).\nWindows PowerShell is a shell developed by Microsoft for task automation and configuration management.\nIt is cross-platform and consists of a command-line shell and scripting language.\nPowerShell capabilities allow users to simplify and automate repetitive tasks by creating scripts and combining multiple commands.\nThe Windows operating system comes with Windows PowerShell pre-installed. However, Windows PowerShell can be installed for other operating systems here: ",(0,a.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/powershell/scripting/install/installing-powershell-core-on-windows?view=powershell-7"},"Windows PowerShell"),".\nAside from Windows PowerShell, the classic Windows Command Prompt is also pre-installed and can be used."),(0,a.kt)("h3",{id:"terminal-for-linux--macos"},"Terminal for Linux & macOS"),(0,a.kt)("p",null,"A terminal is a program that allows the use of the command-line in a graphical environment.\nIn a Linux system, the shell is a command-line interface that interprets a user\u2019s commands and script files, and notifies the server\u2019s operating system what to do with them.\nTerminal is pre-installed on Linux and macOS. For more information, please read ",(0,a.kt)("a",{parentName:"p",href:"https://ubuntu.com/tutorials/command-line-for-beginners#1-overview"},"Ubuntu Tutorials"),".")),(0,a.kt)(i.Z,{mdxType:"Section"},(0,a.kt)("h2",{id:"docker-and-docker-compose"},"Docker and Docker Compose"),(0,a.kt)("p",null,"Using Docker or Docker Compose on Windows and Linux is done via a command line shell and is almost identical on both platforms. You can use PowerShell or Command Prompt on Windows and a shell like bash or zsh on Linux.\nRefer to ",(0,a.kt)("a",{parentName:"p",href:"#system-prerequisites"},"DeepHub System Prerequisites")," for details."),(0,a.kt)("h3",{id:"using-docker-or-docker-compose"},"Using Docker or Docker Compose"),(0,a.kt)("p",null,'We recommend using Docker Compose because this way you will get a completely configured "system" consisting of the DeepHub\xae, the DeepHub\xae UI and a containerized web server, acting as a reverse proxy, to simplify\nthe overall usage and interaction of these components.'),(0,a.kt)("p",null,"We provide a Docker Compose file that configures the necessary orchestration between these containers. Refer to the next section for more details."),(0,a.kt)("p",null,"Nevertheless, you are able to pull just the Docker container that you need instead of all of them."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"docker pull flowcate/deephub:<tag of release you want to pull>\n")),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("p",{parentName:"admonition"},"The DeepHub\xae itself, as well as the corresponding DeepHub\xae UI, are available at Docker Hub: ",(0,a.kt)("a",{parentName:"p",href:"https://hub.docker.com/u/flowcate"},"Flowcate@docker"),".")),(0,a.kt)("h3",{id:"getting-the-latest-docker-compose-file"},"Getting the Latest Docker Compose File"),(0,a.kt)("p",null,"We provide a docker-compose.yml file and additional configuration files for orchestration of the DeepHub\xae itself, as well as the corresponding DeepHub\xae UI, in our GitHub repository: ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/flowcate/deephub-basic-setup"},"deephub-basic-setup by Flowcate@github"),"."),(0,a.kt)("p",null,"We recommend creating a dedicated local directory on your filesystem where you store the docker-compose.yml and the aforementioned configuration files. This happens automatically if you use ",(0,a.kt)("inlineCode",{parentName:"p"},"git clone")," to pull the complete repository. "),(0,a.kt)("p",null,"The DeepHub\xae needs to create some additional files during operations and writes them to directories mounted from your host filesystem. This is done relative to the location of the docker-compose.yml file and will therefore happen within some of the directories that are part of the deephub-basic-setup repository."),(0,a.kt)("h3",{id:"explanation-of-the-docker-compose-file"},"Explanation of the Docker Compose File"),(0,a.kt)("p",null,'Our Docker Compose file consists of four "services":'),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},'"deephub"'),(0,a.kt)("li",{parentName:"ul"},'"deephub-admin-ui"'),(0,a.kt)("li",{parentName:"ul"},'"deephub-kiosk-ui"'),(0,a.kt)("li",{parentName:"ul"},'"deephub-apache"')),(0,a.kt)("p",null,"Each corresponds to one Docker container (indicated by the name).\nWithin each service section, Docker-specific details can be configured as well as environment variables for the processes running within a container. Let's pick an example section:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},'deephub:\n  image: flowcate/deephub:latest\n  container_name: 8081-deephub\n  restart: unless-stopped\n  read_only: true\n  logging:\n    driver: "json-file"\n    options:\n      max-file: "2"\n      max-size: "10m"\n  environment:\n    - DEEPHUB_PORT=7081\n    - DEEPHUB_CORS=true\n    - DEEPHUB_LICENSE_KEY=50f7eb6d-4b4c-4a7b-8d60-0c439328214c\n    - SQLITE_TMPDIR=/data\n  ports:\n    - "7081"\n  volumes:\n    - "./hub-data/:/data"\n  networks:\n    - deephub-net\n')),(0,a.kt)("p",null,'First of all, there is the service name. In this case, it is "deephub". Next are Docker-specific parameters, such as the image name and tag, the name of the container built from the image, the restart policy, and whether the container should run in read-only mode. If the latter is set to "true", no process running within the container is allowed to write to the Docker container\'s own filesystem. After this comes Docker parameters for logging.'),(0,a.kt)("p",null,"The ",(0,a.kt)("strong",{parentName:"p"},"environment")," key begins the section containing the environment variables that are made available within the Docker container. You'll notice DeepHub-specific ones, such as the port on which the DeepHub should listen. ",(0,a.kt)("strong",{parentName:"p"},"All DeepHub-specific environment variables start with DEEPHUB, and are followed by an underscore and the capital spelling of the parameter")," as specified in ",(0,a.kt)("a",{parentName:"p",href:"/docs/deephub/ServerConfiguration"},"Server Configuration"),"."),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"SQLITE_TMPDIR")," variable specifies a path to which the SQlite DB can write temporary information. The path has to be a known path from the point of view of the container and has to be writable."),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"DEEPHUB_PORT")," refers to the port number within the Docker container. However, it is not necessarily identical to the port on which the process is reachable from outside the container. It is the following section, ",(0,a.kt)("strong",{parentName:"p"},"ports"),', that makes this port available from the outside. In this particular case, it is the same port the DeepHub process uses within the container. Instead of that simple entry, a "port mapping" could have been specified - including the outside port number and the corresponding inside port number to which it should be mapped.'),(0,a.kt)("p",null,"The ",(0,a.kt)("strong",{parentName:"p"},"volumes"),' section presents the mapping/mounting of external directories to internal directories within containers. In the example above, the external/host directory called "hub-data", relative to the location of the docker-compose.yml file, is mapped to the absolute path /data within the container. ',(0,a.kt)("strong",{parentName:"p"},"The read-only container can write to this external directory if the user and group permissions on the host filesystem are set appropriately.")),(0,a.kt)("h3",{id:"start-a-deephub"},"Start a DeepHub\xae"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Open a shell (PowerShell or Command Prompt on Windows, a terminal on Linux or macOS)"),(0,a.kt)("li",{parentName:"ul"},"Change to the directory where your docker-compose.yml file resides. ",(0,a.kt)("strong",{parentName:"li"},"Docker Compose won't work if invoked outside this directory.")," "),(0,a.kt)("li",{parentName:"ul"},"Invoke Docker Compose. It will take a few minutes to download the Docker images and set up the DeepHub\xae.")),(0,a.kt)("p",null,"Example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"cd <directory where the docker-compose.yml is>\ndocker compose up -d\n")),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"On Linux, it may be necessary to call docker compose as superuser via the sudo command.")),(0,a.kt)("p",null,"Now you have your own running DeepHub\xae instance that can be accessed with any modern web browser at the address: ",(0,a.kt)("strong",{parentName:"p"},"http://localhost:8081")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"The DeepHub UI",src:o(64606).Z,width:"3047",height:"1568"})),(0,a.kt)("p",null,"To complement the DeepHub UI shown above, you may also make API calls to the DeepHub REST API while running the DeepHub locally. This can be done with a tool such as Postman or cURL."),(0,a.kt)("p",null,"The containerized web server included in the Docker Compose bundle acts as a reverse proxy - forwarding requests to either the DeepHub UI or DeepHub containers."),(0,a.kt)("p",null,"To interact with the REST API, you will need to use the following baseURL: ",(0,a.kt)("strong",{parentName:"p"},"http://localhost:8081/deephub/v1")),(0,a.kt)("p",null,"For example, retrieve an array of all zones:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"curl http://localhost:8081/deephub/v1/zones/summary | json_pp\n")),(0,a.kt)("h3",{id:"stop-a-running-deephub"},"Stop a running DeepHub\xae"),(0,a.kt)("p",null,"Please make sure you are in the same directory where you invoked docker compose."),(0,a.kt)("p",null,"To stop a running DeepHub\xae, execute ",(0,a.kt)("inlineCode",{parentName:"p"},"docker compose down"),". This ensures the running DeepHub\xae is stopped and allows the user to modify the configuration data."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash",metastring:"title='Example'",title:"'Example'"},"cd <directory where the docker-compose.yml is>\ndocker compose down\n")),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"On Linux, it may be necessary to call docker compose as superuser via the sudo command."))),(0,a.kt)(i.Z,{mdxType:"Section"},(0,a.kt)("h2",{id:"install-specific-version"},"Install Specific Version"),(0,a.kt)("p",null,"It is possible to switch to a specific version of the DeepHub\xae instead of the latest one, if required."),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"Before installing a specific version of the DeepHub\xae, it is mandatory to stop a running DeepHub as ",(0,a.kt)("a",{parentName:"p",href:"#stop-a-running-deephub"},"described above"),".")),(0,a.kt)("h3",{id:"pulling-specific-containers"},"Pulling Specific Containers"),(0,a.kt)("p",null,'Open the \u201cdocker-compose.yml\u201d file. Edit the version of the DeepHub\xae from \u201clatest\u201d to the desired version. For example, it can be modified from "latest" to \u201c2.0.0\u201d.\nSimilarly, the version of DeepHub\xae UI can be adapted accordingly.'),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"docker-compose.yml file",src:o(49050).Z,width:"1762",height:"1175"})),(0,a.kt)("br",null),(0,a.kt)("p",null,"Now, the specified version is pulled when executing the following command:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"docker compose pull\n")),(0,a.kt)("p",null,"To start the pulled version, use the typical command described above in ",(0,a.kt)("a",{parentName:"p",href:"#start-a-deephub"},"Start a DeepHub\xae"),".")),(0,a.kt)(i.Z,{mdxType:"Section"},(0,a.kt)("h2",{id:"deephub-ui-configuration"},"DeepHub\xae UI Configuration"),(0,a.kt)("h3",{id:"adding-a-floorplan-image-to-the-map"},"Adding a Floorplan Image to the Map"),(0,a.kt)("p",null,"The DeepHub UI can be configured so that a floorplan image of a building or a site can be displayed. You may choose to display the image by itself, or overlayed on top of the basemap of the mapping service provider (ex. MapTiler)."),(0,a.kt)("p",null,"To begin, you will need to determine the longitude and latitude coordinates of your floorplan images' corners."),(0,a.kt)("p",null,"Once this is done, navigate to the '/hub-web/nginx/webapp' directory of your DeepHub bundle on your local filesystem. Create a new directory (ex. named 'floorplan-image') and add your floorplan image to this directory."),(0,a.kt)("p",null,"Next, download the Open Sans Semibold font by cloning ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/openmaptiles/fonts"},"this repository")," to your local filesystem. Follow the steps in the README.md to install the required packages and generate the fonts. The fonts will be in the '_output' directory."),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"Your machine will need Node.js installed to generate the fonts.")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"user@fc:~/projects/fonts/_output$ ls\n'Metropolis Black'               'Metropolis Light'             'Metropolis Thin'         'Open Sans Extra Bold Italic'  'PT Sans Bold Italic'       'Roboto Black Italic'            'Roboto Condensed Regular'  'Roboto Thin Italic'\n'Metropolis Black Italic'        'Metropolis Light Italic'      'Metropolis Thin Italic'  'Open Sans Italic'             'PT Sans Caption Regular'   'Roboto Bold'                    'Roboto Italic'\n'Metropolis Bold'                'Metropolis Medium'            'Noto Sans Bold'          'Open Sans Light'              'PT Sans Caption Web Bold'  'Roboto Bold Italic'             'Roboto Light'\n'Metropolis Bold Italic'         'Metropolis Medium Italic'     'Noto Sans Italic'        'Open Sans Light Italic'       'PT Sans Italic'            'Roboto Condensed Bold'          'Roboto Light Italic'\n'Metropolis Extra Bold'          'Metropolis Regular'           'Noto Sans Regular'       'Open Sans Regular'            'PT Sans Narrow Bold'       'Roboto Condensed Bold Italic'   'Roboto Medium'\n'Metropolis Extra Bold Italic'   'Metropolis Regular Italic'    'Open Sans Bold'          'Open Sans Semibold'           'PT Sans Narrow Regular'    'Roboto Condensed Italic'        'Roboto Medium Italic'\n'Metropolis Extra Light'         'Metropolis Semi Bold'         'Open Sans Bold Italic'   'Open Sans Semibold Italic'    'PT Sans Regular'           'Roboto Condensed Light'         'Roboto Regular'\n'Metropolis Extra Light Italic'  'Metropolis Semi Bold Italic'  'Open Sans Extra Bold'    'PT Sans Bold'                 'Roboto Black'              'Roboto Condensed Light Italic'  'Roboto Thin'\n")),(0,a.kt)("p",null,"Within your newly-created 'floorplan-image' directory, create a new directory named 'fonts'. Copy the 'Open Sans Semibold' font from the repository you just cloned to this new 'fonts' directory."),(0,a.kt)("h3",{id:"displaying-a-floorplan-image-by-itself"},"Displaying a Floorplan Image by Itself"),(0,a.kt)("p",null,"Create a JSON file in your 'floorplan-image' directory that defines your map style. To display the floorplan image without the surrounding basemap, your file must be structured like the following:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "version": 8,\n    "id": "floorplan-style",\n    "name": "Floorplan Style",\n    "attribution": "Floorplan map",\n    "glyphs": "floorplan-image/fonts/{fontstack}/{range}.pbf",\n    "sources": {\n        "image": {\n            "type": "image",\n            "url": "floorplan-image/<YOUR FLOORPLAN IMAGE FILE>",\n            "coordinates": [\n                [\n                    -115.16786551712569,\n                    36.11988219161837\n                ],\n                [\n                    -115.1654992,\n                    36.119895\n                ],\n                [\n                    -115.1649202,\n                    36.118001\n                ],\n                [\n                    -115.1684502,\n                    36.118023\n                ]\n            ]\n        }\n    },\n    "layers": [{\n            "id": "background",\n            "type": "background",\n            "paint": {\n                "background-color": "rgba(0,0,0,0)"\n            }\n        },\n        {\n            "id": "image-layer",\n            "type": "raster",\n            "source": "image",\n            "paint": {\n                "raster-fade-duration": 0\n            }\n        }\n    ]\n}\n')),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("p",{parentName:"admonition"},"You will need to change the coordinates in your JSON file to match the coordinates of your floorplan images' corners. The first coordinate corresponds to the top left corner of the image, the 2nd coordinate corresponds to the top right corner of the image, etc.")),(0,a.kt)("p",null,"Finally, the 'deephub-ui' services within the docker-compose.yml file of your DeepHub instance need to be modified:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Set DEEPHUB_MAP_DEFAULT_STYLE=floorplan-image/YOUR MAP STYLE JSON FILE"),(0,a.kt)("li",{parentName:"ul"},"Set DEEPHUB_MAP_ACCESS_TOKEN=offline"),(0,a.kt)("li",{parentName:"ul"},'Ensure that the "./hub-web/nginx/webapp/" volume on your local filesystem is mounted to "/webapp" of the Docker container')),(0,a.kt)("p",null,"Start your DeepHub instance by invoking Docker Compose. When you open the DeepHub UI in your browser, you will need to modify the URL by including one pair of longitude and latitude coordinates. For example, to navigate to the location of the floorplan image in the example above, the following URL would be used:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"http://localhost:8081/deephub-admin-ui/map/system/live/(show//left:list)?lng=-115.16786551712569&lat=36.11988219161837&zoom=17\n")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Floorplan image in UI",src:o(98865).Z,width:"3837",height:"2005"})),(0,a.kt)("h3",{id:"displaying-a-floorplan-image-over-a-basemap"},"Displaying a Floorplan Image over a Basemap"),(0,a.kt)("p",null,"To display your floorplan image on top of a basemap from a mapping service provider, you will need to modify your JSON file above, or create a new one. "),(0,a.kt)("p",null,"Combine the properties associated with your floorplan image with the map style JSON of the mapping service provider. By default, MapTiler is used as the mapping service provider with this map style: ",(0,a.kt)("a",{parentName:"p",href:"https://api.maptiler.com"},"https://api.maptiler.com/maps/bright/style.json"),"."),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"You need a license from MapTiler to access and use the styles and the mapping service.")),(0,a.kt)("p",null,"In addition, you will need to ensure that the docker-compose.yml file of your DeepHub instance has the correct value for ",(0,a.kt)("inlineCode",{parentName:"p"},"DEEPHUB_MAP_DEFAULT_STYLE"),". This environment variable should point to the location of the updated map style JSON file on your local filesystem. For example:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"DEEPHUB_MAP_DEFAULT_STYLE=floorplan-image/YOUR UPDATED MAP STYLE JSON FILE")),(0,a.kt)("p",null,"If you are using your own license for MapTiler or Mapbox, ensure you specify this with the following environment variable:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"DEEPHUB_MAP_ACCESS_TOKEN=YOUR ACCESS TOKEN")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Floorplan image in UI over basemap",src:o(15589).Z,width:"3832",height:"2005"})),(0,a.kt)("h3",{id:"multi-level-floorplans"},"Multi-Level Floorplans"),(0,a.kt)("p",null,"If the building or site has multiple floors, you will need to include a floorplan image for each individual floor."),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"Your DeepHub instance will need to have zones, fences, trackables, or location providers on each floor that needs to display a floorplan image.")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"#adding-a-floorplan-image-to-the-map"},"As described above"),", you will first need to determine the longitude and latitude coordinates of the corners of each floorplan image and ensure each floorplan image is included in the 'floorplan-image' directory."),(0,a.kt)("p",null,'Modify your map style JSON by including "minlevel" and "maxlevel" as properties. By default, the map starts at floor 0. '),(0,a.kt)("p",null,"For example, to display a two-floor building without the surrounding basemap, your map style JSON would be structured in the following way:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "version": 8,\n    "id": "floorplan-style",\n    "name": "Floorplan Style",\n    "attribution": "Floorplan map",\n    "glyphs": "floorplan-image/fonts/{fontstack}/{range}.pbf",\n    "sources": {\n        "floor0": {\n            "type": "image",\n            "url": "floorplan-image/<YOUR FLOORPLAN IMAGE FILE FOR FLOOR 0>",\n            "coordinates": [\n                [\n                    -115.16786551712569,\n                    36.11988219161837\n                ],\n                [\n                    -115.1654992,\n                    36.119895\n                ],\n                [\n                    -115.1649202,\n                    36.118001\n                ],\n                [\n                    -115.1684502,\n                    36.118023\n                ]\n            ]\n        },\n        "floor1": {\n            "type": "image",\n            "url": "floorplan-image/<YOUR FLOORPLAN IMAGE FILE FOR FLOOR 1>",\n            "coordinates": [\n                [\n                    -115.16786551712569,\n                    36.11988219161837\n                ],\n                [\n                    -115.1654992,\n                    36.119895\n                ],\n                [\n                    -115.1649202,\n                    36.118001\n                ],\n                [\n                    -115.1684502,\n                    36.118023\n                ]\n            ]\n        }\n    },\n    "layers": [{\n            "id": "background",\n            "type": "background",\n            "paint": {\n                "background-color": "rgba(0,0,0,0)"\n            }\n        },\n        {\n            "id": "floor0-layer",\n            "type": "raster",\n            "source": "floor0",\n            "paint": {\n                "raster-fade-duration": 0\n            },\n            "minlevel": 0,\n            "maxlevel": 1\n        },\n        {\n            "id": "floor1-layer",\n            "type": "raster",\n            "source": "floor1",\n            "paint": {\n                "raster-fade-duration": 0\n            },\n            "minlevel": 1,\n            "maxlevel": 2\n        }\n    ]\n}\n')),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("p",{parentName:"admonition"},'The value of the "minlevel" property corresponds with the floor upon which the floorplan image is displayed in the DeepHub UI. The value of the "maxlevel" property is always the subsequent floor.'))))}m.isMDXComponent=!0},64606:(e,t,o)=>{o.d(t,{Z:()=>n});const n=o.p+"assets/images/deephub-ui-03f4447adc906003404b1e821c9415b0.jpg"},49050:(e,t,o)=>{o.d(t,{Z:()=>n});const n=o.p+"assets/images/docker_yml_edit-a6520f3ab58f8bbfa9831142a322f8a9.png"},98865:(e,t,o)=>{o.d(t,{Z:()=>n});const n=o.p+"assets/images/floorplan_alone-5d9b89bf7ace2f6348eaf070ad5d2a5b.png"},15589:(e,t,o)=>{o.d(t,{Z:()=>n});const n=o.p+"assets/images/floorplan_basemap-bb809b2cf393b5414c8c36d584cb5e9e.png"}}]);